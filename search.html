<!DOCTYPE html>
<html>

<head>
    <title>Search Page</title>
</head>

<body>

    <h1>ค้นหาสินค้า : จากรหัสสินค้าหรือชื่อสินค้า</h1>
    <input type="text" id="uname" name="uname">
    <input type="date" id="fdate" name="fdate">
    <input type="date" id="ldate" name="ldate">
    <button type="button" onclick="onSubmit();">Search Now!</button>
    <br><br>
    <div>
        <div id="progress" style="display:none;">
            <img src="images/progress.gif" width="200" height="200">
        </div>
        <div id="result"></div>
    </div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    $(document).ajaxStart(function() {
        $("#progress").css("display", "block");
    });

    $(document).ajaxComplete(function() {
        $("#progress").css("display", "none");
    });

    function onSubmit() {
        $(document).ready(function() {
            $("#result").html('');

            var oSearch = {
                txtSearch: $("#txtSearch").val()
            };

            $.ajax({
                type: "POST",
                url: "http://ff2eb6d4.ngrok.io/Search",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(oSearch),
                success: function(res) {
                    if (res == "No data found.") {
                        $("#result").html(res);
                    } else {
                        var content = "";
                        $.each(res, function() {
                            content += ("<tr>" +
                                "<td>" + this.XFsahGrand + "</td>");
                        });
                        $("<table border=\"1\">").html(
                            "<thead> " +
                            "<tr>" +
                            "<th> <strong> ยอดขายสินค้า </strong> </th>" +
                            "</tr>" +
                            "</thead>" +
                            "<tbody>" +
                            content +
                            "</tbody>" +
                            "</table>"
                        ).appendTo("#result");
                    }
                },
                error: function(res) {
                    alert("เกิดข้อผิดพลาด " + res);
                }
            });
        });
    };
</script>

</html>